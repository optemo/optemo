<div <%= 'class="listview_ungrouped"' if @s.search.groupby.nil? && @s.directLayout %> >
	<%mb={}%>
	<% mb['featured'] = landing_main_boxes('featured') #Calculate mb before navtitle %>
	<div id='navigator_bar_top'>
	    <div id='navtitle'><%= Session.search.products_size.to_s + ' ' + raw(navtitle) %></div><%= link_to image_tag("see_all_white#{fr?}.gif"),root_path, :class=>"seeall" %></div>
<div id="hero">
    <% hero = Product.find_by_id(Maybe(SearchProduct.find_hero).product_id) || Product.find_by_product_type(Session.product_type) %>
    <%# Cache specs local to the view so as to reduce SQL calls / cache hits / object instantiations %>
    <% cont_specs = ContSpec.cache_all(hero.id); cat_specs = CatSpec.cache_all(hero.id); text_spec = TextSpec.cacheone(hero.id, "productUrl#{fr?}") %>
    <%= image_tag(cat_specs["imglurl"], :class => "productimg", :alt => small_title(hero), :title => small_title(hero), :'data-id' => hero.id, :'data-sku' => hero.sku) %>
    <div class="heroinfo">
		<%= link_to I18n.locale == :fr ? cat_specs["title#{fr?}"] : hero.title, text_spec, :'data-id' => hero.id, :'data-sku' => hero.sku, :class => "easylink", :title => t('products.compare.clickforspecs') %>
		<div class="productspecs"><%=featuretext(hero.id) %></div>	
		<% if BinSpec.cache_all(hero.id)["onsale"] %>
			<div class="saleprice">
			<%= t('products.compare.onsale')+(fr?.empty? ? "" : " ")+": "+number_to_currency(cont_specs["saleprice"]) %></div>	
			<div class="save"><%= t('products.compare.save')+(fr?.empty? ? "" : " ")+": "+ number_to_currency(cont_specs["price"]-cont_specs["saleprice"]) %></div>
		    <div class="saleends"><%= t('products.show.saleends')+": "%><%= l((Date.parse(cat_specs["saleEndDate"]) - 1.day), :format => :long) if cat_specs["saleEndDate"] %></div>
		<% else %>
			<div class="price">
				$<%= number_with_delimiter(cont_specs["price"]) %>
			</div>	
		<% end %>
		<% if cont_specs["customerRating"] > 0 %>
			<div class="stars" data-stars="<%= cont_specs["customerRating"] %>"></div>
		<% end %>
		    <div style='margin-top: 50px'><%= link_to image_tag("shopnow#{fr?}.gif"), "http://www.bestbuy.ca/order/addtocart.ashx?accessories=#{hero.sku}", {:'data-sku' =>hero.sku, :class => 'spacer shop-now addcart', :'data-name' =>small_title(hero)} %></div>
	</div>
    <div style='clear:both; width:0;height: 0;'></div>   
</div>


<% if @s.product_type == 'camera_bestbuy' %><div class='showcase_banner_div'><%= link_to image_tag("#{@s.product_type}-banner#{fr?}.jpg"), '#', :class => 'showcase_banner', :"data-brand" => "Canon" %></div><% else %>
<div class='showcase_banner_div'><%= link_to image_tag("#{@s.product_type}-banner#{fr?}.jpg"), '#', :class => 'showcase_banner', :"data-sku" => "10172122" %></div>
<% end %>
<%= raw mb['featured'] %>

<div style="clear:both;"><span id="actioncount" style="display:none"><%= [Session.search.id.to_s].pack("m").chomp %></span></div>
